\hypertarget{_b_n_o08x_s_h2_h_a_l_8hpp_source}{}\doxysection{BNO08x\+SH2\+HAL.\+hpp}
\label{_b_n_o08x_s_h2_h_a_l_8hpp_source}\index{/media/develop/git/imu\_pr\_cleanup/components/esp32\_BNO08x/include/BNO08xSH2HAL.hpp@{/media/develop/git/imu\_pr\_cleanup/components/esp32\_BNO08x/include/BNO08xSH2HAL.hpp}}
\mbox{\hyperlink{_b_n_o08x_s_h2_h_a_l_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{comment}{// hill-\/crest labs includes (apache 2.0 license, compatible with MIT)}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}sh2.h"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}sh2\_SensorValue.h"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}sh2\_err.h"{}}}
\DoxyCodeLine{12 \textcolor{comment}{// esp-\/idf includes}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <esp\_log.h>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <esp\_timer.h>}}
\DoxyCodeLine{15 \textcolor{comment}{// in-\/house includes}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_b_n_o08x_private_types_8hpp}{BNO08xPrivateTypes.hpp}}"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define UINT16\_CLR\_MSB(val\_16bit) ((val\_16bit) \& 0x00FFU)}}
\DoxyCodeLine{25 }
\DoxyCodeLine{32 \textcolor{preprocessor}{\#define UINT16\_CLR\_LSB(val\_16bit) ((val\_16bit) \& 0xFF00U)}}
\DoxyCodeLine{33 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define UINT32\_CLR\_BYTE(val\_32bit, byte2clear) ((val\_32bit) \& \string~(0xFFUL << (byte2clear * 8UL)))}}
\DoxyCodeLine{42 }
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define UINT32\_MSK\_BYTE(val\_32bit, byte2mask) ((val\_32bit) \& (0xFFUL << (byte2mask * 8UL)))}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{comment}{// parsing universal to any packet}}
\DoxyCodeLine{53 }
\DoxyCodeLine{60 \textcolor{preprocessor}{\#define PARSE\_PACKET\_LENGTH(header)                                                                                              \(\backslash\)}}
\DoxyCodeLine{61 \textcolor{preprocessor}{    (UINT16\_CLR\_LSB(static\_cast<uint16\_t>(header[1]) << 8U) | UINT16\_CLR\_MSB(static\_cast<uint16\_t>(header[0])))}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{comment}{// forward dec to prevent compile errors}}
\DoxyCodeLine{64 \textcolor{keyword}{class }\mbox{\hyperlink{class_b_n_o08x}{BNO08x}};}
\DoxyCodeLine{65 }
\DoxyCodeLine{71 \textcolor{keyword}{class }\mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l}{BNO08xSH2HAL}}}
\DoxyCodeLine{72 \{}
\DoxyCodeLine{73     \textcolor{keyword}{public}:}
\DoxyCodeLine{74         \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a236ccf0ff8d36060b465bc1f4f0a37fa}{set\_hal\_imu}}(\mbox{\hyperlink{class_b_n_o08x}{BNO08x}}* hal\_imu);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76         \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_ae079b1384cba806a778eb0e27f981da0}{spi\_open}}(sh2\_Hal\_t* self);}
\DoxyCodeLine{77         \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a5fa6b901d1790fcd7dc0905f62ae040f}{spi\_close}}(sh2\_Hal\_t* self);}
\DoxyCodeLine{78         \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a3e691461235b3e3c59866ac179d06f25}{spi\_read}}(sh2\_Hal\_t* self, uint8\_t* pBuffer, \textcolor{keywordtype}{unsigned} len, uint32\_t* t\_us);}
\DoxyCodeLine{79         \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a96d5b8fa7669f22cd0ecaf1feee13299}{spi\_write}}(sh2\_Hal\_t* self, uint8\_t* pBuffer, \textcolor{keywordtype}{unsigned} len);}
\DoxyCodeLine{80         \textcolor{keyword}{static} uint32\_t \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_ad89b6a3166e2eee003ad87a517a31cd5}{get\_time\_us}}(sh2\_Hal\_t* self);}
\DoxyCodeLine{81         \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a1add67e38698c9f33541af7bd2912d8f}{hal\_cb}}(\textcolor{keywordtype}{void}* cookie, sh2\_AsyncEvent\_t* pEvent);}
\DoxyCodeLine{82         \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_b_n_o08x_s_h2_h_a_l_a19c041ef614d7eda85b94b10202a3997}{sensor\_event\_cb}}(\textcolor{keywordtype}{void}* cookie, sh2\_SensorEvent\_t* event);}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keyword}{private}:}
\DoxyCodeLine{85         \textcolor{keyword}{static} \mbox{\hyperlink{class_b_n_o08x}{BNO08x}}* imu;}
\DoxyCodeLine{86         \textcolor{keyword}{static} \textcolor{keywordtype}{void} hardware\_reset();}
\DoxyCodeLine{87         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} spi\_wait\_for\_int();}
\DoxyCodeLine{88         \textcolor{keyword}{static} uint16\_t spi\_read\_sh2\_packet\_header(uint8\_t* pBuffer);}
\DoxyCodeLine{89         \textcolor{keyword}{static} \textcolor{keywordtype}{int} spi\_read\_sh2\_packet\_body(uint8\_t* pBuffer, uint16\_t packet\_sz);}
\DoxyCodeLine{90 }
\DoxyCodeLine{91         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{char}* TAG = \textcolor{stringliteral}{"{}BNO08xSH2HAL"{}};}
\DoxyCodeLine{92 \};}

\end{DoxyCode}
